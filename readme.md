## AWS Code Pipeline 

This is a simple hello world spring boot app

#### AWS Code Build

This step uses buildspec.yml file, reference guide for this file is at
https://docs.aws.amazon.com/codebuild/latest/userguide/build-spec-ref.html  


#### AWS Code Deploy

This step uses appspec.yml file, reference guide for this file is at
https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file-structure.html  

We need to create below roles : 

EC2ForCodeDeploy : Attach policy for AmazonEC2RoleForAWSCodeDeploy, AmazonS3FullAccess
This role will be used to deploy code into EC2, and this role will also be used to read build artifacts generated by CodeBuild into S3.  

CodeDeployRole : Attach policy for AWSCodeDeployRole, this role is for CodeDeployService

Then Create an EC2 instance (name: DemoEC2ForCodeDeploy), and launch instance from dashboard, and add below for its user data section (setup):  
```
#!/bin/bash
sudo yum update
sudo yum install ruby
sudo yum install wget
cd /home/ec2-user
wget https://aws-codedeploy-us-east-1.s3.us-east-1.amazonaws.com/latest/install
chmod +x ./install
sudo ./install auto
sudo yum install -y python-pip
sudo pip install awscli
sudo amazon-linux-extras install java-openjdk11
``` 

Then Create CodeDeploy group  
Then create CodePipeline  

If Code Deploy fails, then check logs with below command :  
`less /var/log/aws/codedeploy-agent/codedeploy-agent.log`  
In my case, i found it was because no IAM role was attached to my EC2 instance, so I attached one, and restarted the cloud deploy agent.  
`sudo service codedeploy-agent restart`  
`sudo service codedeploy-agent status`  
